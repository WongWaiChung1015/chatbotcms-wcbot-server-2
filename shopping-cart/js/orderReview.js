"use strict";function SetupUI(){$("#btn_proceed").click(onBtnProceed),$("#btn_back").click(onBtnBack)}function RenderItemsIntoTable(){for(var t="",e=0,r=0,a=window._shoppingCart.server_settings.currency,i=0,o=window._wcOrder.line_items.length;i<o;++i){var n=window._wcOrder.line_items[i];n.subtotal=parseFloat(n.subtotal),n.subtotal_tax=parseFloat(n.subtotal_tax),n.total=parseFloat(n.total),n.total_tax=parseFloat(n.total_tax);for(var d=null,l=0,s=window._shoppingCart.cart_items.length;l<s;++l){var u=window._shoppingCart.cart_items[l];if(u.product_id==n.product_id){d=u;break}}d.qty=parseFloat(d.qty),d.unit_price=parseFloat(d.unit_price),d.unit_tax=n.subtotal_tax/n.quantity,d.subtotal=n.subtotal+n.subtotal_tax,e+=n.subtotal,r+=n.subtotal_tax,t+="<tr>",t+="<td>",t+='<img src="'+d.image+'" />',t+="</td>",t+="<td>",t+=d.name,t+="</td>",t+='<td style="text-align: right">',t+=d.qty,t+="</td>",t+='<td style="text-align: right">',t+=util.ParseCurrencyToDisp(a,d.unit_price,!1),t+="</td>",t+='<td style="text-align: right">',t+=util.ParseCurrencyToDisp(a,d.unit_tax,!1),t+="</td>",t+='<td style="text-align: right">',t+=util.ParseCurrencyToDisp(a,d.subtotal),t+="</td>",t+="</tr>"}var c=parseFloat(window._wcOrder.shipping_total),_=parseFloat(window._wcOrder.shipping_tax),w=e+r+c+_;$("#order_total").html(util.ParseCurrencyToDisp(a,e)),$("#order_tax").html(util.ParseCurrencyToDisp(a,r)),$("#ship_total").html(util.ParseCurrencyToDisp(a,c)),$("#ship_tax").html(util.ParseCurrencyToDisp(a,_)),$("#total_amount").html(util.ParseCurrencyToDisp(a,w)),$("#table_items tbody").html(t)}function LoadShoppingCart(){return $.ajax({method:"GET",url:"ws/db_loadcart",data:{uid:window._userId,rid:window._recipientId}})}function LoadWcOrder(){return $.ajax({method:"GET",url:"get_wc_order",data:{uid:window._userId,rid:window._recipientId,oid:window._orderId}})}function RemoveWcOrder(){return $.ajax({type:"DELETE",url:"ws/delete_order",data:{oid:window._orderId,uid:window._userId,rid:window._recipientId}})}function EnableAllButtons(t){t?($("#btn_proceed").removeClass("disabled loading"),$("#btn_back").removeClass("disabled loading")):($("#btn_proceed").addClass("disabled loading"),$("#btn_back").addClass("disabled loading"))}function onBtnBack(t){var e=$("#dlg_discardwarn");e.modal("show"),e.find("#btn_ok").click(function(t){EnableAllButtons(!1),RemoveWcOrder().done(function(){var t="mwp?page=shopCart&uid="+window._userId+"&rid="+window._recipientId;window.location.href=t}).fail(function(t,e,r){$.alert({type:"red",useBootstrap:!1,title:r,content:t.responseText})})}),e.find("#btn_cancel").click(function(t){$("#dlg_discardwarn").modal("hide")})}function onBtnProceed(t){EnableAllButtons(!1),window.location.href="mwp?page=orderPayment&oid="+window._orderId+"&uid="+window._userId+"&rid="+window._recipientId}$(document).ready(function(){RenderItemsIntoTable(),$(".loading_wrapper").hide(),$(".loaded_wrapper").show(),SetupUI()});